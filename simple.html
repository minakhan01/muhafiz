<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <!-- Bootstrap stuff -->
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap-theme.min.css">
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <script src="dist/locationpicker.jquery.min.js"></script>
      <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAx0nk-kqKOI0rvEmHVdWcB8oj2f5_5HXA&libraries=places"
  type="text/javascript"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <script src="https://cdn.firebase.com/js/client/2.3.1/firebase.js"></script>

  <script>
  $(function() {
    $( "#datepicker" ).datepicker().show();
  });
  </script>
    <title>Simple example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div class="form-horizontal" style="width: 550px">
    <div class="form-group">
    <div class="dropdown">
        <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Type of crime
        <span class="caret"></span></button>
        <ul class="dropdown-menu">
        <li><a href="#">Murder</a></li>
        <li><a href="#">Rape</a></li>
        <li><a href="#">Theft</a></li>
        <li><a href="#">Robbery</a></li>
        </ul>
    </div>
    </div>
    <div class="form-group">
    Date: <input type="text" id="datepicker">
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">Location:</label>

        <div class="col-sm-10"><input type="text" class="form-control" id="us3-address"/></div>
    </div>
    <div id="us3" style="width: 550px; height: 400px;"></div>
    <div class="clearfix">&nbsp;</div>
    <div class="m-t-small">
        <label class="p-r-small col-sm-1 control-label">Lat.:</label>

        <div class="col-sm-3"><input type="text" class="form-control" style="width: 110px" id="us3-lat"/></div>
        <label class="p-r-small col-sm-2 control-label">Long.:</label>

        <div class="col-sm-3"><input type="text" class="form-control" style="width: 110px" id="us3-lon"/></div>
    </div>
    <input type="submit" id="submitButton" value="Submit">
    <div class="clearfix"></div>
</div>
    <script>
    var crime = "";
    var myFirebaseRef = new Firebase("https://safe-spot.firebaseio.com/");

    
    $("#submitButton").click(function(){
    var latitude = $('#us3-lat')[0].value;
    var longitude = $('#us3-lon')[0].value;
    var address = $('#us3-address')[0].value;
    var date = $('#datepicker')[0].value;

    // Generate a reference to a new location and add some data using push()
    var newPostRef = myFirebaseRef.push();
    newPostRef.set({time: Firebase.ServerValue.TIMESTAMP , 
        lon: longitude,
        lat: latitude,
        address: address,
        date: date,
        crime: crime});
    // Get the unique ID generated by push()
    var postID = newPostRef.key();
    console.log(date);
    });

    $(".dropdown-menu li a").click(function(){
    $(this).parents(".dropdown").find('.btn').html($(this).text() + ' <span class="caret"></span>');
    crime = $(this).text();
    });

    $('#us3').locationpicker({
        location: {latitude: 46.15242437752303, longitude: 2.7470703125},
        radius: 300,
        inputBinding: {
            latitudeInput: $('#us3-lat'),
            longitudeInput: $('#us3-lon'),
            radiusInput: $('#us3-radius'),
            locationNameInput: $('#us3-address')
        },
        enableAutocomplete: true,
        onchanged: function (currentLocation, radius, isMarkerDropped) {
            // Uncomment line below to show alert on each Location Changed event
            //alert("Location changed. New location (" + currentLocation.latitude + ", " + currentLocation.longitude + ")");
        }
    });
    </script>
</body>
</html>